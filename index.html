<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="robots" content="index,follow" />
  <!-- 
    CSP: Remplacer <N8N_DOMAIN> par votre domaine n8n réel avant déploiement.
    Exemple: connect-src 'self' https://n8n.votre-domaine.com;
    Note: frame-ancestors doit être défini via HTTP header, pas meta tag.
  -->
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self';
             img-src 'self' data:;
             style-src 'self' 'unsafe-inline';
             script-src 'self';
             connect-src 'self' https://<N8N_DOMAIN>;
             base-uri 'self';" />
  <title>Audit Automation — Agences Créatives</title>
  <link rel="icon" href="assets/favicon.ico" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <img src="assets/logo.png" alt="Alpha No-Code" class="brand__logo" />
        <div class="brand__text">
          <div class="brand__name">Alpha No-Code</div>
          <div class="brand__tag">Audit Automation — Agences Créatives</div>
        </div>
      </div>
      <nav class="topbar__nav">
        <a class="topbar__link" href="politique-confidentialite.html" target="_blank" rel="noopener">
          Politique de confidentialité
        </a>
      </nav>
    </header>

    <main class="main" role="main">
      <div class="card">
        <div id="banner" class="banner banner--hidden" role="alert" aria-live="polite"></div>

        <div class="stephead">
          <div id="stepKicker" class="stephead__kicker"></div>
          <h1 id="stepTitle" class="stephead__title"></h1>
          <p id="stepSubtitle" class="stephead__subtitle"></p>
        </div>

        <div id="stepBody" class="stepbody"></div>

        <!-- DEV: Payload live -->
        <section id="devPanel" class="dev dev--hidden" aria-label="Panneau développeur">
          <div class="dev__head">
            <div class="dev__title">DEV — Payload live</div>
            <div class="dev__actions">
              <button id="copyPayloadBtn" class="btn btn--ghost" type="button">Copier JSON</button>
            </div>
          </div>
          <pre id="devPayload" class="dev__pre"></pre>
        </section>

        <!-- Page 7: analyse -->
        <section id="analysisWrap" class="analysis analysis--hidden" aria-label="Analyse express">
          <div class="analysis__meta">
            <div class="analysis__id">
              <span class="muted">Référence :</span>
              <span id="submissionId" class="mono"></span>
              <button id="copyIdBtn" class="btn btn--ghost btn--xs" type="button">Copier</button>
            </div>
            <button id="restartBtnTop" class="btn btn--ghost" type="button">Recommencer</button>
          </div>
          <!-- iframe isolée + sandboxée -->
          <iframe
            id="analysisFrame"
            class="analysis__frame"
            title="Analyse express"
            sandbox="allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation">
          </iframe>
          <div class="analysis__actions">
            <a id="calendlyBtn" class="btn btn--primary" href="#" target="_blank" rel="noopener">
              Réserver sur Calendly
            </a>
            <button id="restartBtn" class="btn btn--ghost" type="button">Recommencer</button>
          </div>
        </section>
      </div>
    </main>

    <!-- Sticky bottom bar -->
    <footer class="sticky" role="contentinfo">
      <div class="sticky__left">
        <div class="sticky__progressWrap">
          <div id="progressText" class="sticky__progress"></div>
          <div class="sticky__save" id="saveState"></div>
        </div>
        <div class="sticky__bar">
          <div id="progressBar" class="sticky__barFill" style="width:0%"></div>
        </div>
      </div>
      <div class="sticky__right">
        <button id="prevBtn" class="btn btn--ghost" type="button">Précédent</button>
        <button id="nextBtn" class="btn btn--primary" type="button">Suivant</button>
      </div>
    </footer>
  </div>

  <script src="app.js"></script>
</body>
</html>
